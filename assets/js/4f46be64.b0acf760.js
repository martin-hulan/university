"use strict";(self.webpackChunkuniversity=self.webpackChunkuniversity||[]).push([[8684],{3219:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>s,metadata:()=>r,toc:()=>l});var o=t(5893),i=t(1151);const s={title:"Coupa: Integration setup",sidebar_position:1,sidebar_label:"Integration setup"},a=void 0,r={id:"learn/coupa/coupa-integration-setup",title:"Coupa: Integration setup",description:"1. Coupa part",source:"@site/docs/learn/coupa/coupa-integration-setup.md",sourceDirName:"learn/coupa",slug:"/learn/coupa/coupa-integration-setup",permalink:"/docs/learn/coupa/coupa-integration-setup",draft:!1,unlisted:!1,editUrl:"https://github.com/rossumai/university/tree/master/docs/learn/coupa/coupa-integration-setup.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"Coupa: Integration setup",sidebar_position:1,sidebar_label:"Integration setup"},sidebar:"learnSidebar",previous:{title:"Coupa",permalink:"/docs/learn/coupa/"},next:{title:"Import setup",permalink:"/docs/learn/coupa/coupa-import-setup"}},c={},l=[{value:"1. Coupa part",id:"1-coupa-part",level:2},{value:"2. Rossum part",id:"2-rossum-part",level:2},{value:"Webhook in UI",id:"webhook-in-ui",level:3},{value:"Hook secret schema",id:"hook-secret-schema",level:3},{value:"Patch token lifetime",id:"patch-token-lifetime",level:3},{value:"Initial test",id:"initial-test",level:2},{value:"Debugging",id:"debugging",level:2},{value:"Available configuration options",id:"available-configuration-options",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,i.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h2,{id:"1-coupa-part",children:"1. Coupa part"}),"\n",(0,o.jsxs)(n.p,{children:["The main prerequisite is to have a valid Coupa user with needed permissions (see ",(0,o.jsx)(n.a,{href:"/docs/learn/coupa/coupa-oauth-scopes",children:"OAuth 2.0 scopes"}),"). If you don't have a user with needed permission, ask your admin to create it."]}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsxs)(n.p,{children:["You can always (also) check the official documentation ",(0,o.jsx)(n.a,{href:"https://compass.coupa.com/en-us/products/core-platform/integration-playbooks-and-resources/integration-knowledge-articles/oauth-2.0-getting-started-with-coupa-api",children:"OAuth 2.0 Getting Started with Coupa API"})]})}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["Login to the Coupa web admin at URL ",(0,o.jsx)(n.code,{children:"https://[example-company].coupacloud.com"})]}),"\n",(0,o.jsxs)(n.li,{children:["Go to the Setup, search for keyword ",(0,o.jsx)(n.code,{children:"oauth"})," and click the one result ",(0,o.jsx)(n.strong,{children:"OAuth2/OpenID Connect Clients"})]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.img,{alt:"Coupa Setup User",src:t(4260).Z+"",width:"2972",height:"770"}),"\n3. Find the user prepared for the integration and note the values ",(0,o.jsx)(n.code,{children:"Identifier"})," and ",(0,o.jsx)(n.code,{children:"Secrets"}),". You will need it for every hook setup later"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"alt text",src:t(5833).Z+"",width:"1964",height:"1012"})}),"\n",(0,o.jsxs)(n.ol,{start:"4",children:["\n",(0,o.jsxs)(n.li,{children:["For the start, this scopes should works for basic integration ",(0,o.jsx)(n.code,{children:"core.accounting.read, core.common.read, core.invoice.create, core.invoice.read, core.invoice.write, core.purchase_order.read, core.supplier.read"})," - you can copy and paste it exactly like this when using the Postman collection provided by Coupa"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"2-rossum-part",children:"2. Rossum part"}),"\n",(0,o.jsx)(n.p,{children:"Coupa service (integration) is provided by Rossum.ai in the form of webhook. To start using Coupa (either imports or exports), follow these steps:"}),"\n",(0,o.jsx)(n.h3,{id:"webhook-in-ui",children:"Webhook in UI"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"Login to your Rossum account."}),"\n",(0,o.jsxs)(n.li,{children:["Navigate to ",(0,o.jsx)(n.strong,{children:"Extensions \u2192 My extensions"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Click on ",(0,o.jsx)(n.strong,{children:"Create extension"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Fill the following fields:","\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["Name: ",(0,o.jsx)(n.code,{children:"Coupa: Import/Export [what]"})]}),"\n",(0,o.jsxs)(n.li,{children:["Trigger events: ",(0,o.jsx)(n.code,{children:"Manual"})," (later also ",(0,o.jsx)(n.code,{children:"Scheduled"}),")"]}),"\n",(0,o.jsxs)(n.li,{children:["Extension type: ",(0,o.jsx)(n.code,{children:"Webhook"})]}),"\n",(0,o.jsx)(n.li,{children:"URL (see below)"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["Click ",(0,o.jsx)(n.strong,{children:"Create the webhook"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Fill ",(0,o.jsx)(n.code,{children:"Configuration"})," (see ",(0,o.jsx)(n.a,{href:"/docs/learn/coupa/coupa-import-configuration-examples",children:"Import Examples"})," or ",(0,o.jsx)(n.a,{href:"/docs/learn/coupa/coupa-export-configuration-examples",children:"Export Examples"}),")"]}),"\n",(0,o.jsx)(n.li,{children:'(Optional): if you have access to the "Django", you can update secret schema so it will be easily updated. See the JSON snippet below'}),"\n",(0,o.jsxs)(n.li,{children:["Fill ",(0,o.jsx)(n.code,{children:"Secrets"})," fields."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"hook-secret-schema",children:"Hook secret schema"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "type": "object",\n  "properties": {\n    "client_secret": {\n      "type": "string",\n      "description": "API OAuth Client secret"\n    }\n  },\n  "additionalProperties": false\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["As a result of this change, it is somehow easy to update ",(0,o.jsx)(n.code,{children:"client_secret"})]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"Client Secret",src:t(8258).Z+"",width:"1176",height:"414"})}),"\n",(0,o.jsx)(n.h3,{id:"patch-token-lifetime",children:"Patch token lifetime"}),"\n",(0,o.jsx)(n.p,{children:"Patch the token lifetime to 2 minutes"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"curl --location --request PATCH 'https://[company-example].rossum.app/api/v1/hooks/[hook-id]' \\\n--header 'Authorization: Bearer [token] \\\n--header 'Content-Type: application/json' \\\n--data '{\"token_lifetime_s\": 120}'\n"})}),"\n",(0,o.jsx)(n.h2,{id:"initial-test",children:"Initial test"}),"\n",(0,o.jsxs)(n.p,{children:["You can invoke the webhook manually using ",(0,o.jsx)(n.strong,{children:"curl"})," (for example):"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"curl --location --request POST 'https://[company-example].rossum.app/api/v1/hooks/[hook-id]/invoke' \\\n--header 'Authorization: token [token]' \\\n--data ''\n"})}),"\n",(0,o.jsx)(n.p,{children:"Then go to the Rossum Extension Logs and observe the content"}),"\n",(0,o.jsx)(n.h2,{id:"debugging",children:"Debugging"}),"\n",(0,o.jsxs)(n.p,{children:["When the Extension logs don't provide enough information for the proper debugging, it is needed to lookup the ES for logs using corresponding ",(0,o.jsx)(n.code,{children:"request_id"})," (taken from the Extensions logs)."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"alt text",src:t(6622).Z+"",width:"1716",height:"782"})}),"\n",(0,o.jsxs)(n.p,{children:["x",(0,o.jsx)(n.img,{alt:"alt text",src:t(450).Z+"",width:"3532",height:"944"})]}),"\n",(0,o.jsx)(n.h2,{id:"available-configuration-options",children:"Available configuration options"}),"\n",(0,o.jsx)(n.admonition,{title:"Work in progress",type:"warning",children:(0,o.jsx)(n.p,{children:(0,o.jsx)(n.em,{children:"Describe all relevant configuration options."})})})]})}function p(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},4260:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/coupa-setup-1-858783afe2fbec219c31121ff699e046.png"},5833:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/coupa-setup-2-032e1cb858fc3291c6b3b83b7d6d4914.png"},450:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/debug-elastic-2909ac2192693ce23a30d87e335b409a.png"},6622:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/debug-logs-a349552ebc254cb95e4115b0cd282a83.png"},8258:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/hook-schema-update-62a4e2af2fdcbf05142cb1e29c384747.png"},1151:(e,n,t)=>{t.d(n,{Z:()=>r,a:()=>a});var o=t(7294);const i={},s=o.createContext(i);function a(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);