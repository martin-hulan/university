"use strict";(self.webpackChunkuniversity=self.webpackChunkuniversity||[]).push([[226],{3261:(e,n,t)=>{t.d(n,{Ay:()=>l,RM:()=>s});var i=t(4848),r=t(8453);const s=[];function o(e){const n={a:"a",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Environment"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Webhook URL"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"EU1 Ireland"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:e.eu1?(0,i.jsx)(n.a,{href:e.eu1,children:e.eu1}):"\u2014"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"EU2 Frankfurt"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:e.eu2?(0,i.jsx)(n.a,{href:e.eu2,children:e.eu2}):"\u2014"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"US east coast"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:e.us?(0,i.jsx)(n.a,{href:e.us,children:e.us}):"\u2014"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Japan Tokyo"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:e.jp?(0,i.jsx)(n.a,{href:e.jp,children:e.jp}):"\u2014"})]})]})]})}function l(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},101:(e,n,t)=>{t.d(n,{Ay:()=>l,RM:()=>s});var i=t(4848),r=t(8453);const s=[];function o(e){const n={a:"a",admonition:"admonition",p:"p",...(0,r.R)(),...e.components};return(0,i.jsxs)(n.admonition,{title:"Work in progress",type:"warning",children:[(0,i.jsxs)(n.p,{children:["We're still working on this part and would love to hear your thoughts! Feel free to ",(0,i.jsx)(n.a,{href:"https://github.com/rossumai/university/discussions",children:"share your feedback"})," or ",(0,i.jsx)(n.a,{href:"https://github.com/rossumai/university/pulls",children:"submit a pull request"}),". Thank you! \ud83d\ude4f"]}),e.issue?(0,i.jsxs)(n.p,{children:["Tracking issue: ",(0,i.jsx)(n.a,{href:e.issue,children:e.issue})]}):""]})}function l(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},9712:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>x,frontMatter:()=>a,metadata:()=>i,toc:()=>p});const i=JSON.parse('{"id":"learn/export-pipeline/rest-api-export","title":"Export pipelines: REST API export","description":"Installation","source":"@site/docs/learn/export-pipeline/rest-api-export.md","sourceDirName":"learn/export-pipeline","slug":"/learn/export-pipeline/rest-api-export","permalink":"/docs/learn/export-pipeline/rest-api-export","draft":false,"unlisted":false,"editUrl":"https://github.com/rossumai/university/tree/master/docs/learn/export-pipeline/rest-api-export.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Export pipelines: REST API export","sidebar_label":"3. REST API export","sidebar_position":3},"sidebar":"learnSidebar","previous":{"title":"2. Custom format templating","permalink":"/docs/learn/export-pipeline/custom-format-templating"},"next":{"title":"4. Data value extractor","permalink":"/docs/learn/export-pipeline/data-value-extractor"}}');var r=t(4848),s=t(8453),o=t(3261),l=t(101);const a={title:"Export pipelines: REST API export",sidebar_label:"3. REST API export",sidebar_position:3},d="REST API export",c={},p=[{value:"Installation",id:"installation",level:2},...o.RM,{value:"Basic usage",id:"basic-usage",level:2},...l.RM,{value:"Available configuration options",id:"available-configuration-options",level:2},...l.RM,{value:"Configuration examples",id:"configuration-examples",level:2},{value:"Simple REST API call",id:"simple-rest-api-call",level:3},{value:"REST API call with OAuth2",id:"rest-api-call-with-oauth2",level:3},{value:"Sending <code>multipart/form-data</code>",id:"sending-multipartform-data",level:3},{value:"Sending <code>application/x-www-form-urlencoded</code>",id:"sending-applicationx-www-form-urlencoded",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"rest-api-export",children:"REST API export"})}),"\n",(0,r.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(n.p,{children:"REST API export extension is provided and maintained by Rossum.ai in the form of webhook. To start using it, follow these steps:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Login to your Rossum account."}),"\n",(0,r.jsxs)(n.li,{children:["Navigate to ",(0,r.jsx)(n.strong,{children:"Extensions \u2192 My extensions"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Click on ",(0,r.jsx)(n.strong,{children:"Create extension"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Fill the following fields:","\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Name: ",(0,r.jsx)(n.code,{children:"REST API export"})]}),"\n",(0,r.jsxs)(n.li,{children:["Trigger events: ",(0,r.jsx)(n.code,{children:"Export"})]}),"\n",(0,r.jsxs)(n.li,{children:["Extension type: ",(0,r.jsx)(n.code,{children:"Webhook"})]}),"\n",(0,r.jsx)(n.li,{children:"URL (see below)"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Click ",(0,r.jsx)(n.strong,{children:"Create the webhook"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Fill in the ",(0,r.jsx)(n.code,{children:"Configuration"})," field (see ",(0,r.jsx)(n.a,{href:"#configuration-examples",children:"Configuration examples"})," for some examples)."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Webhook URL endpoints:"}),"\n",(0,r.jsx)(o.Ay,{eu1:"https://elis.rest-api-export.rossum-ext.app/",eu2:"https://shared-eu2.rest-api-export.rossum-ext.app/",us:"https://us.rest-api-export.rossum-ext.app/",jp:"https://shared-jp.rest-api-export.rossum-ext.app/"}),"\n",(0,r.jsx)(n.h2,{id:"basic-usage",children:"Basic usage"}),"\n",(0,r.jsx)(l.Ay,{}),"\n",(0,r.jsx)(n.h2,{id:"available-configuration-options",children:"Available configuration options"}),"\n",(0,r.jsx)(l.Ay,{}),"\n",(0,r.jsx)(n.h2,{id:"configuration-examples",children:"Configuration examples"}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsxs)(n.p,{children:["This extension currently expects file to be generated using ",(0,r.jsx)(n.a,{href:"/docs/learn/export-pipeline/custom-format-templating",children:"Custom format templating extension"}),"."]})}),"\n",(0,r.jsx)(n.h3,{id:"simple-rest-api-call",children:"Simple REST API call"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "export_reference_key": "export_annotation_to_csv",\n  "request": {\n    "url": "https://webhook.site/XXX-ZZZ",\n    "method": "POST",\n    "headers": {\n      "Content-Type": "text/plain"\n    },\n    "content": "#{file_content}"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"rest-api-call-with-oauth2",children:"REST API call with OAuth2"}),"\n",(0,r.jsx)(n.p,{children:"The request can be extended to use OAuth2:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "export_reference_key": "export_annotation_to_csv",\n  "auth": {\n    "url": "http://custom.url/token",\n    "method": "POST",\n    "data": {\n      "username": "your_username",\n      "password": "{secret.password}"\n    }\n  },\n  "request": {\n    "url": "https://webhook.site/XXX-ZZZ",\n    "method": "POST",\n    "headers": {\n      "Content-Type": "text/plain",\n      "Authorization": "Bearer {secret.access_token}"\n    },\n    "content": "#{file_content}"\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"access_token"})," is automatically retrieved using given credentials and saved to hook secrets for later reuse. A more complex OAuth2 setup:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "export_reference_key": "export_annotation_to_csv",\n  "request": {\n    "url": "https://webhook.site/XXX-ZZZ",\n    "method": "POST",\n    "headers": {\n      "Content-Type": "text/json"\n    },\n    "content": "#{file_content}"\n  },\n  "auth": {\n    "url": "http://custom.url/token",\n    "method": "POST",\n    "data": {\n      "scope": "invoice.create invoice.read",\n      "client_id": "{secret.client_id}",\n      "grant_type": "client_credentials",\n      "client_secret": "{secret.client_secret}"\n    },\n    "headers": {\n      "Content-Type": "application/x-www-form-urlencoded"\n    }\n  },\n  "condition": "@{api_gate}",\n  "response_headers_reference_key": "export_reply_headers",\n  "response_payload_reference_key": "export_reply_payload"\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Please note the ",(0,r.jsx)(n.code,{children:"response_headers_reference_key"})," and ",(0,r.jsx)(n.code,{children:"response_payload_reference_key"}),". The first stores the headers of the reply (with added ",(0,r.jsx)(n.code,{children:"status_code"}),"), the later stores the full body from the reply. Both of them can be retrieved via API (the link to the received data is stored with the desired key in annotation's metadata). There is an extension prepared for you, that will extract key values (Extract data)."]}),"\n",(0,r.jsxs)(n.p,{children:["For original file use ",(0,r.jsx)(n.code,{children:"#{original_file}"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["You can use condition that controls whether the export is triggered. If the referred field is non-empty (",(0,r.jsx)(n.code,{children:'!= ""'}),") it will start export and skip it if it is empty (",(0,r.jsx)(n.code,{children:'== ""'}),")."]}),"\n",(0,r.jsxs)(n.h3,{id:"sending-multipartform-data",children:["Sending ",(0,r.jsx)(n.code,{children:"multipart/form-data"})]}),"\n",(0,r.jsxs)(n.p,{children:["The following config will translate in an HTTP POST request with ",(0,r.jsx)(n.code,{children:"Content-Type: multipart/form-data"}),". Both file and additional data will be sent. For sending the file, the ",(0,r.jsx)(n.code,{children:"file_key"})," is used as a form-data ",(0,r.jsx)(n.code,{children:"name; filename"})," and content type are taken from the saved document."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "export_reference_key": "exported_annotation_csv",\n  "request": {\n    "url": "https://webhook.site/XXX-ZZZ",\n    "method": "POST",\n    "headers": {\n      "Authorization": "Bearer {secret.token}"\n    },\n    "file_name": "@{document_id}.json",\n    "file_key": "file",\n    "request_data": {\n      "other_field": "@{vendor}"\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["See also ",(0,r.jsx)(n.a,{href:"/docs/learn/json-templating/",children:"JSON templating"}),"."]}),"\n",(0,r.jsxs)(n.h3,{id:"sending-applicationx-www-form-urlencoded",children:["Sending ",(0,r.jsx)(n.code,{children:"application/x-www-form-urlencoded"})]}),"\n",(0,r.jsx)(n.p,{children:"Specifically, this example is for Azure API Management:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "export_reference_key": "exported_annotation_csv",\n  "auth": {\n    "url": "",\n    "method": "POST",\n    "headers": {\n      "Ocp-Apim-Subscription-Key": "",\n      "Content-Type": "application/x-www-form-urlencoded"\n    },\n    "data": {\n      "grant_type": "",\n      "client_id": "",\n      "client_secret": "{secret.client_secret}",\n      "scope": ""\n    }\n  },\n  "request": {\n    "url": "",\n    "method": "POST",\n    "content": "#{file_content}",\n    "headers": {\n      "Content-Type": "application/json",\n      "Ocp-Apim-Subscription-Key": ""\n    }\n  }\n}\n'})})]})}function x(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>l});var i=t(6540);const r={},s=i.createContext(r);function o(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);